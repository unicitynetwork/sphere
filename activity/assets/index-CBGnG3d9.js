import{i as h,f as S,C as s,t as i,b as a,e as u,I as g,p as b,a as P,U as w,d as o,c as E,s as D}from"./index-B239lf3G.js";import"./index-Dyd6I8eL.js";const c=Symbol.for("@libp2p/peer-id"),p=Symbol.for("nodejs.util.inspect.custom"),C=114;class n{type;multihash;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[c]=!0;toString(){return this.string==null&&(this.string=a.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return s.createV1(C,this.multihash)}toJSON(){return this.toString()}equals(e){if(e==null)return!1;if(e instanceof Uint8Array)return u(this.multihash.bytes,e);if(typeof e=="string")return this.toString()===e;if(e?.toMultihash()?.bytes!=null)return u(this.multihash.bytes,e.toMultihash().bytes);throw new Error("not valid Id")}[p](){return`PeerId(${this.toString()})`}}class d extends n{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}}class f extends n{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.publicKey}}class y extends n{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.publicKey}}const A=2336;class I{type="url";multihash;publicKey;url;constructor(e){this.url=e.toString(),this.multihash=h.digest(S(this.url))}[p](){return`PeerId(${this.url})`}[c]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return s.createV1(A,this.toMultihash())}toJSON(){return this.toString()}equals(e){return e==null?!1:(e instanceof Uint8Array&&(e=i(e)),e.toString()===this.toString())}}const T=114,l=2336;function O(t,e){let r;if(t.charAt(0)==="1"||t.charAt(0)==="Q")r=o(a.decode(`z${t}`));else{if(t.startsWith("k51qzi5uqu5")||t.startsWith("kzwfwjn5ji4")||t.startsWith("k2k4r8")||t.startsWith("bafz"))return K(s.parse(t));if(e==null)throw new E('Please pass a multibase decoder for strings that do not start with "1" or "Q"');r=o(e.decode(t))}return m(r)}function _(t){if(t.type==="Ed25519")return new f({multihash:t.toCID().multihash,publicKey:t});if(t.type==="secp256k1")return new y({multihash:t.toCID().multihash,publicKey:t});if(t.type==="RSA")return new d({multihash:t.toCID().multihash,publicKey:t});throw new w}function x(t){return _(t.publicKey)}function m(t){if(R(t))return new d({multihash:t});if(M(t))try{const e=b(t);if(e.type==="Ed25519")return new f({multihash:t,publicKey:e});if(e.type==="secp256k1")return new y({multihash:t,publicKey:e})}catch{const r=i(t.digest);return new I(new URL(r))}throw new P("Supplied PeerID Multihash is invalid")}function K(t){if(t?.multihash==null||t.version==null||t.version===1&&t.code!==T&&t.code!==l)throw new g("Supplied PeerID CID is invalid");if(t.code===l){const e=i(t.multihash.digest);return new I(new URL(e))}return m(t.multihash)}function M(t){return t.code===h.code}function R(t){return t.code===D.code}export{K as peerIdFromCID,m as peerIdFromMultihash,x as peerIdFromPrivateKey,_ as peerIdFromPublicKey,O as peerIdFromString};
